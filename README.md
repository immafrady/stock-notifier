# stock-notifier

轻量级的股市价格监控命令行工具，会发送系统级的通知

## 目录

- [特性](#特性)
- [安装方式](#安装方式)
- [使用方式](#使用方式)
- [功能说明](#功能说明)
- [支持](#支持)

## 特性

- [x] 支持查询股票代码
- [x] 支持定时播报
- [x] 支持订制查询频率
- [x] 支持在特定的场景下弹出通知
  - [x] 股价连续x次单边走势时弹出通知
  - [x] 股票两个时间段内变化差额超过x时弹出通知
  - [x] 股票两个时间段内变化幅度超过x%时弹出通知
  - [x] 股价超过x时弹出通知
  - [x] 股价跌破x时弹出通知
  - [x] 监控ETF的溢价率超过某个值时弹出通知

## 安装方式

### 方法一：通过 `go install`

```shell
go install github.com/immafrady/stock-notifier@latest
```

### 方法二：下载可执行文件

1. 前往 [GitHub Release](https://github.com/immafrady/stock-notifier/releases) 页面。
2. 找到适合您操作系统的可执行文件并下载。
3. 添加下载后的文件到您的系统 PATH 中（可选）。

## 使用方式

### 1. 初始化配置文件

```shell
stock-notifier init [-p/--path <路径>] [-t/--type <类型>]
```

参数说明
- -p / --path：指定配置文件的输出地址（可选，默认输出在当前工作目录下）
- -t / --type：指定配置文件的类型（可选，默认是 jsonc）支持类型包括：
  - jsonc
  - json
  - yaml
  - yml

### 2. 搜索股票信息

```shell
stock-notifier search <股票代码1> <股票代码2> ...
```

支持使用空格分隔多个股票代码进行搜索。

### 3. 运行监控

```shell
stock-notifier run [-c/--config <配置文件路径>]
```

参数说明
- -c / --config：指定配置文件的路径（可选，默认使用当前工作目录下的配置文件）

## 示例

1. 初始化配置文件到 /etc/stock-config.yaml 并设置类型为 yaml：

```shell
stock-notifier init -p /etc/stock-config.yaml -t yaml
```

2. 搜索股票信息：

```shell
stock-notifier search AAPL TSLA 00700
```

3. 使用指定的配置文件运行：

```shell
stock-notifier run -c /etc/stock-config.yaml
```

## 功能说明

以下是配置并配上完整的说明

```json lines
{ 
  /*
  * 1. 自定义监控时间段
  *    - 用途：工具将在指定的时间段内进行股票数据轮询
  *    - 说明：支持定义多个时间段，不填写就全时段
  */
  "updates": [{
    "from": "09:00",
    "to": "11:30"
  }, {
    "from": "13:00",
    "to": "15:00"
  }],
  /*
  * 2. 播报功能
  *    - 用途：用于在关键时间点对监控的股票进行汇总播报通知，如“午间收盘”或“下午收盘”。
  *    - 说明：支持在指定时间自动播报消息
  */
  "broadcast": [{
    "time": "11:31",
    "label": "午间收盘"
  }, {
    "time": "15:01",
    "label": "本日收盘"
  }],
  /*
  * 3. 个股监控功能
  *    - 用途：为每只股票单独配置监控参数
  *    - 说明：上面的配置都是为了这个功能存在的，支持配置多个股票代码
  */
  "trackers": [
    {
      /*
      * 3.1 股票代码
      *     - 用途：核心参数，用来进行股票信息的查询
      *     - 说明：将通过stock-notifier search查询出来的“查询代码”完整复制到这里；
      *     -      支持大A、港股、美股、ETF、LOF等
      */
      "code": "sh000001",
      /*
      * 3.2 轮询频率
      *     - 用途：查询股票请求的轮询间隔时间
      *     - 说明：支持最低频率为5秒，输入的参数会就近取5s的倍数；
      *     -      支持秒 (s)、分钟 (m)、小时 (h) 为单位。
      */
      "frequency": "5s",
      /*
      * 3.3 连续波动监控
      *     - 用途：对连续上涨或下跌进行提醒
      *     - 说明：会对每次轮询的结果进行大小比较
      *     - 参数：请填写大于 2 的[整数]，填写数值小于 2 时不启用提醒
      */
      "continuous": 9, 
      /*
      * 3.3 价格差异监控
      *     - 用途：支持对两次轮询的价格差进行监控
      *     - 说明：差价超过设定值时会弹出提示
      *     - 参数：请填写大于 0 的[浮点数]，填写数值小于等于 0 时不启用提醒
      */
      "priceDiff": 1, 
      /*
      * 3.4 百分比波动监控
      *     - 用途：支持对两次轮询的价格百分比差异进行监控
      *     - 说明：超过配置的百分比时会提醒（支持正负波动）
      *     - 参数：请填写大于 0 的[带%结尾字符串]，填写数值小于等于 0 时不启用提醒
      */
      "percentDiff": "1%",
      /*
      * 3.5 【ETF专用】溢价/折价率监控
      *     - 用途：ETF的当前价格与“实时净值”有较大差异时弹出提醒
      *     - 说明：超过设定阈值时触发提示
      *     - 参数：请填写大于 0 的[带%结尾字符串]，填写数值小于等于 0 时不启用提醒
      */
      "realTimePercentDiff": "1%",
      /*
      * 3.6 目标价位监控
      *     - 用途：支持设置当达到价格目标时提醒
      *     - 说明：超过目标高价或低于目标低价时弹出提醒（震荡行情可能会连续触发）
      *     - 参数：请填写大于 0 的[浮点数]，填写数值小于等于 0 时不启用提醒
      */
      "targetHighPrice": 30,
      "targetLowPrice": 30,
      /*
      * 3.7 单独时间段覆盖
      *     - 用途：覆盖默认的监控时间端
      *     - 说明：未定义时使用全局默认时间段
      */
      "updates": null
    }
  ]
}
```

### 

## 支持

如果您有任何问题或建议，请提交 [Issue](https://github.com/immafrady/stock-notifier/issues)。